"use strict";var config={isKhGh:yo.getQueryString("isKhGh")||0,role:localStorage.userRole,api_detail:"/mainIndex/showSwgwYjmbDetatil",time:yo.getQueryString("time"),id:yo.getQueryString("id"),saleName:yo.getQueryString("saleName"),api_user:"/user/getUserInfo",ch:yo.getQueryString("ch"),jidu:yo.getQueryString("jidu"),type:yo.getQueryString("type")};"销售精英"!=config.role&&"经理"!=config.role||(config.isKhGh=4);var app={},app2={},app3={},app4={},option=null,option2=null,option3=null,option4=null;option={title:{text:"",textStyle:{color:"#3a3a3a",fontStyle:"normal",fontSize:16}},tooltip:{trigger:"axis"},legend:{data:["商务顾问业绩目标完成情况"]},xAxis:{type:"category",data:[]},yAxis:{type:"value",max:""},series:[{data:[],type:"line",symbol:"circle",symbolSize:6,areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#d9ebfd"},{offset:.5,color:"#f6fafe"},{offset:.8,color:"#ffffff"}])}},itemStyle:{normal:{color:"#459df5"}}}]},option2={title:{text:"",textStyle:{color:"#3a3a3a",fontStyle:"normal",fontSize:16}},tooltip:{trigger:"axis"},legend:{data:["商务顾问业绩目标完成情况"]},xAxis:{type:"category",data:[]},yAxis:{type:"value",max:""},series:[{data:[],type:"line",symbol:"circle",symbolSize:6,areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#d9ebfd"},{offset:.5,color:"#f6fafe"},{offset:.8,color:"#ffffff"}])}},itemStyle:{normal:{color:"#459df5"}}}]},option3={title:{text:"",textStyle:{color:"#3a3a3a",fontStyle:"normal",fontSize:16}},tooltip:{trigger:"axis"},legend:{data:["商务顾问业绩目标完成情况"]},xAxis:{type:"category",data:[]},yAxis:{type:"value",max:""},series:[{data:[],type:"line",symbol:"circle",symbolSize:6,areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#d9ebfd"},{offset:.5,color:"#f6fafe"},{offset:.8,color:"#ffffff"}])}},itemStyle:{normal:{color:"#459df5"}}}]},option4={title:{text:"",textStyle:{color:"#3a3a3a",fontStyle:"normal",fontSize:16}},tooltip:{trigger:"axis"},legend:{data:["商务顾问业绩目标完成情况"]},xAxis:{type:"category",data:[]},yAxis:{type:"value",max:""},series:[{data:[],type:"line",symbol:"circle",symbolSize:6,areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#d9ebfd"},{offset:.5,color:"#f6fafe"},{offset:.8,color:"#ffffff"}])}},itemStyle:{normal:{color:"#459df5"}}}]};var labelTop={normal:{color:"#fdb54e",label:{show:!0,position:"center",formatter:"{b}",textStyle:{baseline:"top",fontSize:14}},labelLine:{show:!1}}},labelFromatter={normal:{label:{formatter:function(e){return 100-e.value+"%"},textStyle:{baseline:"top"}}}},labelBottom={normal:{color:"#d3d6da",label:{show:!0,position:"center",fontSize:12},labelLine:{show:!1}},emphasis:{color:"#d3d6da"}},radius=["80%","90%"],pieChartOption={title:{text:"",subtext:"",x:"center"},animation:!1,tooltip:{trigger:"axis",showDelay:0,hideDelay:50,transitionDuration:0,borderRadius:8,borderWidth:2,padding:10},series:[{type:"pie",center:["50%","55%"],radius:radius,x:"0%",itemStyle:labelTop,data:[{name:"0%",value:0,itemStyle:labelTop},{name:"到款金额进度",value:0,itemStyle:labelBottom}]}]},labelTop2={normal:{color:"#53c1a6",label:{show:!0,position:"center",formatter:"{b}",textStyle:{baseline:"top",fontSize:14}},labelLine:{show:!1}}},labelFromatter2={normal:{label:{formatter:function(e){return 100-e.value+"%"},textStyle:{baseline:"top"}}}},labelBottom2={normal:{color:"#d3d6da",label:{show:!0,position:"center",fontSize:12},labelLine:{show:!1}},emphasis:{color:"#d3d6da"}},radius2=["80%","90%"],pieChartOption2={title:{text:"",subtext:"",x:"center"},animation:!1,tooltip:{trigger:"axis",showDelay:0,hideDelay:50,transitionDuration:0,borderRadius:8,borderWidth:2,padding:10},series:[{type:"pie",center:["50%","55%"],radius:radius2,x:"0%",itemStyle:labelTop2,data:[{name:"0%",value:0,itemStyle:labelTop2},{name:"合同数量进度",value:0,itemStyle:labelBottom2}]}]},labelTop3={normal:{color:"#fdb54e",label:{show:!0,position:"center",formatter:"{b}",textStyle:{baseline:"top",fontSize:14}},labelLine:{show:!1}}},labelFromatter3={normal:{label:{formatter:function(e){return 100-e.value+"%"},textStyle:{baseline:"top"}}}},labelBottom3={normal:{color:"#d3d6da",label:{show:!0,position:"center",fontSize:12},labelLine:{show:!1}},emphasis:{color:"#d3d6da"}},radius3=["80%","90%"],pieChartOption3={title:{text:"",subtext:"",x:"center"},animation:!1,tooltip:{trigger:"axis",showDelay:0,hideDelay:50,transitionDuration:0,borderRadius:8,borderWidth:2,padding:10},series:[{type:"pie",center:["50%","55%"],radius:radius3,x:"0%",itemStyle:labelTop3,data:[{name:"0%",value:0,itemStyle:labelTop3},{name:"委案金额进度",value:0,itemStyle:labelBottom3}]}]},labelTop4={normal:{color:"#53c1a6",label:{show:!0,position:"center",formatter:"{b}",textStyle:{baseline:"top",fontSize:14}},labelLine:{show:!1}}},labelFromatter4={normal:{label:{formatter:function(e){return 100-e.value+"%"},textStyle:{baseline:"top"}}}},labelBottom4={normal:{color:"#d3d6da",label:{show:!0,position:"center",fontSize:12},labelLine:{show:!1}},emphasis:{color:"#d3d6da"}},radius4=["80%","90%"],pieChartOption4={title:{text:"",subtext:"",x:"center"},animation:!1,tooltip:{trigger:"axis",showDelay:0,hideDelay:50,transitionDuration:0,borderRadius:8,borderWidth:2,padding:10},series:[{type:"pie",center:["50%","55%"],radius:radius4,x:"0%",itemStyle:labelTop4,data:[{name:"0%",value:0,itemStyle:labelTop4},{name:"拜访量进度",value:0,itemStyle:labelBottom4}]}]};require(["select2"],function(e){window.app=new Vue({el:"#app",data:{dxmonth:(new Date).getFullYear().toString(),dxmonth2:config.time.split("-")[0],dxmonth3:config.time.split("-")[0],dxmonth4:config.time.split("-")[0],dx:{dkje:"",mbdkje:"",htsl:"",mbhtsl:"",ddje:"",mbddje:"",list:[],list2:[],list3:[],list4:[],idchange2:"",idchange3:"",gxtime:"",gxtime2:"",gxtime3:"",gxtime4:""},saleId:config.id,saleId2:config.id,saleId3:config.id,saleId4:config.id,listId:[]},watch:{dxmonth:function(e){this.getYjmb(this.dxmonth,0,this.saleId)},saleId:function(e){this.getYjmb(this.dxmonth,0,this.saleId)},dxmonth2:function(e){this.getYjmb2(this.dxmonth2,1,this.saleId2,1)},saleId2:function(e){this.getYjmb2(this.dxmonth2,1,this.saleId2,2)},dxmonth3:function(e){this.getYjmb3(this.dxmonth3,2,this.saleId3,1)},saleId3:function(e){this.getYjmb3(this.dxmonth3,2,this.saleId3,2)},dxmonth4:function(e){this.getYjmb4(this.dxmonth4,3,this.saleId4)},saleId4:function(e){this.getYjmb4(this.dxmonth4,3,this.saleId4)}},computed:{},created:function(){document.getElementById("app").classList.remove("hide")},mounted:function(){var i=this;laydate.render({elem:"#dxmonth",type:"year",done:function(e,t){i.dxmonth=e}}),laydate.render({elem:"#dxmonth2",type:"year",done:function(e,t){i.dxmonth2=e}}),laydate.render({elem:"#dxmonth3",type:"year",done:function(e,t){i.dxmonth3=e}}),laydate.render({elem:"#dxmonth4",type:"year",done:function(e,t){i.dxmonth4=e}}),this.getYjmb(i.dxmonth,0,config.id),this.getYjmb2(i.dxmonth2,1,config.id),this.getYjmb3(i.dxmonth3,2,config.id),this.getYjmb4(i.dxmonth4,3,config.id),this.getUser()},methods:{loading:function(e){"close"==e?layer.close(this.loadingSwitch):this.loadingSwitch=layer.load(3)},getUser:function(){var t=this;t.loading(),$.ajax({type:"post",url:config.api_user,async:!0,data:{ROLE_ID:"b729e9334ad64c15a4e47d88b8c2638f,e350acd05a6244c79136616302b7dfd6,008615f04f39499fb73e5f323add988a,6f247fed28e94194ac66020e55957496,28f1842e2463492a9eb6ddf0def91658,73340766cf3d43af91daff3128adad84,b62d6d19bed64ee199f2c1a5b252b57b"},success:function(e){t.loading("close"),t.listId=e}})},getYjmb:function(l,e,r){var s,m,x=this,t=l+"-04-01",i=Number(l)+1+"-03-31";$.ajax({type:"post",url:config.api_detail,async:!0,data:{startTime:t,endTime:i,type:e,saleId:r},success:function(t){if(x.loading("close"),"00"==t.error){for(var e=[],i=[],a=0;a<t.result.length;a++){var o=t.result[a];e.push(o.name),i.push(o.dkje)}0==config.jidu||1==config.jidu||2==config.jidu||3==config.jidu?(x.dx.gxtime=config.jidu,x.dx.dkje=t.result[config.jidu].dkje||0,x.dx.mbdkje=t.result[config.jidu].mbdkje||0):(x.dx.gxtime=0,x.dx.dkje=t.result[0].dkje||0,x.dx.mbdkje=t.result[0].mbdkje||0),"Infinity"==(s=Math.round(x.dx.dkje/x.dx.mbdkje*1e4)/100)?s=100:isNaN(s)&&(s=0),m=s+"%",x.dxhx(s,m,l,x.dx.gxtime,r);var d=Number(Math.max.apply(null,i));d+=.2*d;var n=echarts.init(document.getElementById("main"));option.xAxis.data=["一季度","二季度","三季度","四季度"],option.yAxis.max=Math.ceil(d),option.series[0].data=i,n.setOption(option),n.off("click"),n.on("click",function(e){x.dx.gxtime=e.dataIndex,x.dx.dkje=t.result[e.dataIndex].dkje||0,x.dx.mbdkje=t.result[e.dataIndex].mbdkje||0,"Infinity"==(s=Math.round(x.dx.dkje/x.dx.mbdkje*1e4)/100)?s=100:isNaN(s)&&(s=0),m=s+"%",x.dxhx(s,m,l,x.dx.gxtime,r)})}else layer.msg(t.msg)}})},getYjmb2:function(e,t,i,l){var r,s,m=this,x=m.nowMonth(),a=e+"-04-01",o=Number(e)+1+"-03-31";$.ajax({type:"post",url:config.api_detail,async:!0,data:{startTime:a,endTime:o,type:t,saleId:i},success:function(t){if(m.loading("close"),"00"==t.error){for(var e=[],i=[],a=0;a<t.result.length;a++){var o=t.result[a];e.push(o.name),i.push(o.htsl)}if(null==l){if(0==config.jidu||1==config.jidu||2==config.jidu||3==config.jidu)for(a=0;a<t.result.length;a++)x==t.result[a].time&&(m.dx.gxtime2=t.result[a].time,m.dx.idchange2=a,m.dx.htsl=t.result[a].htsl||0,m.dx.mbhtsl=t.result[a].mbhtsl||0,"Infinity"==(r=Math.round(m.dx.htsl/m.dx.mbhtsl*1e4)/100)?r=100:isNaN(r)&&(r=0));else for(a=0;a<t.result.length;a++)config.jidu==t.result[a].time&&(m.dx.gxtime2=t.result[a].time,m.dx.idchange2=a,m.dx.htsl=t.result[a].htsl||0,m.dx.mbhtsl=t.result[a].mbhtsl||0,"Infinity"==(r=Math.round(m.dx.htsl/m.dx.mbhtsl*1e4)/100)?r=100:isNaN(r)&&(r=0));s=r+"%",m.dxhx2(r,s,m.dx.gxtime2)}else 1==l?(m.dx.gxtime2=t.result[m.dx.idchange2].time,m.dx.gxtime2=t.result[m.dx.idchange2].time,m.dx.htsl=t.result[m.dx.idchange2].htsl||0,m.dx.mbhtsl=t.result[m.dx.idchange2].mbhtsl||0,"Infinity"==(r=Math.round(m.dx.htsl/m.dx.mbhtsl*1e4)/100)?r=100:isNaN(r)&&(r=0),s=r+"%",m.dxhx2(r,s,m.dx.gxtime2)):2==l&&(m.dx.gxtime2=t.result[m.dx.idchange2].time,m.dx.htsl=t.result[m.dx.idchange2].htsl||0,m.dx.mbhtsl=t.result[m.dx.idchange2].mbhtsl||0,"Infinity"==(r=Math.round(m.dx.htsl/m.dx.mbhtsl*1e4)/100)?r=100:isNaN(r)&&(r=0),s=r+"%",m.dxhx2(r,s,m.dx.gxtime2));var d=Number(Math.max.apply(null,i));d+=.2*d;var n=echarts.init(document.getElementById("main2"));option2.xAxis.data=["四月份","五月份","六月份","七月份","八月份","九月份","十月份","十一月份","十二月份","一月份","二月份","三月份"],option2.yAxis.max=Math.ceil(d),option2.series[0].data=i,n.setOption(option2),n.off("click"),n.on("click",function(e){m.dx.gxtime2=t.result[e.dataIndex].time,m.dx.idchange2=e.dataIndex,m.dx.htsl=t.result[e.dataIndex].htsl||0,m.dx.mbhtsl=t.result[e.dataIndex].mbhtsl||0,"Infinity"==(r=Math.round(m.dx.htsl/m.dx.mbhtsl*1e4)/100)?r=100:isNaN(r)&&(r=0),s=r+"%",m.dxhx2(r,s,m.dx.gxtime2)})}else layer.msg(t.msg)}})},getYjmb3:function(e,t,i,l){var r,s,m=this,x=m.nowMonth(),a=e+"-04-01",o=Number(e)+1+"-03-31";$.ajax({type:"post",url:config.api_detail,async:!0,data:{startTime:a,endTime:o,type:t,saleId:i},success:function(t){if(m.loading("close"),"00"==t.error){for(var e=[],i=[],a=0;a<t.result.length;a++){var o=t.result[a];e.push(o.name),i.push(o.ddje)}if(null==l){if(0==config.jidu||1==config.jidu||2==config.jidu||3==config.jidu)for(a=0;a<t.result.length;a++)x==t.result[a].time&&(m.dx.gxtime3=t.result[a].time,m.dx.idchange3=a,m.dx.ddje=t.result[a].ddje||0,m.dx.mbddje=t.result[a].mbddje||0,"Infinity"==(r=Math.round(m.dx.ddje/m.dx.mbddje*1e4)/100)?r=100:isNaN(r)&&(r=0));else for(a=0;a<t.result.length;a++)config.jidu==t.result[a].time&&(m.dx.gxtime3=t.result[a].time,m.dx.idchange3=a,m.dx.ddje=t.result[a].ddje||0,m.dx.mbddje=t.result[a].mbddje||0,"Infinity"==(r=Math.round(m.dx.ddje/m.dx.mbddje*1e4)/100)?r=100:isNaN(r)&&(r=0));s=r+"%",m.dxhx3(r,s,m.dx.gxtime3)}else 1==l?(m.dx.gxtime3=t.result[m.dx.idchange3].time,m.dx.ddje=t.result[m.dx.idchange3].ddje||0,m.dx.mbddje=t.result[m.dx.idchange3].mbddje||0,"Infinity"==(r=Math.round(m.dx.ddje/m.dx.mbddje*1e4)/100)?r=100:isNaN(r)&&(r=0),s=r+"%",m.dxhx3(r,s,m.dx.gxtime3)):2==l&&(m.dx.gxtime3=t.result[m.dx.idchange3].time,m.dx.ddje=t.result[m.dx.idchange3].ddje||0,m.dx.mbddje=t.result[m.dx.idchange3].mbddje||0,"Infinity"==(r=Math.round(m.dx.ddje/m.dx.mbddje*1e4)/100)?r=100:isNaN(r)&&(r=0),s=r+"%",m.dxhx3(r,s,m.dx.gxtime3));var d=Number(Math.max.apply(null,i));d+=.2*d;var n=echarts.init(document.getElementById("main3"));option3.xAxis.data=["四月份","五月份","六月份","七月份","八月份","九月份","十月份","十一月份","十二月份","一月份","二月份","三月份"],option3.yAxis.max=Math.ceil(d),option3.series[0].data=i,n.setOption(option3),n.off("click"),n.on("click",function(e){m.dx.idchange3=e.dataIndex,m.dx.gxtime3=t.result[e.dataIndex].time,m.dx.ddje=t.result[e.dataIndex].ddje||0,m.dx.mbddje=t.result[e.dataIndex].mbddje||0,console.log(m.dx.ddje),"Infinity"==(r=Math.round(m.dx.ddje/m.dx.mbddje*1e4)/100)?r=100:isNaN(r)&&(r=0),s=r+"%",m.dxhx3(r,s,m.dx.gxtime3)})}else layer.msg(t.msg)}})},getYjmb4:function(e,t,i){var a=this,o=(a.nowMonth(),e+"-04-01"),d=Number(e)+1+"-03-31";$.ajax({type:"post",url:config.api_detail,async:!0,data:{startTime:o,endTime:d,type:t,saleId:i},success:function(e){a.loading("close"),"00"==e.error||layer.msg(e.msg)}})},dxhx:function(e,t,i,a,o){var d;pieChartOption.series[0].data[0].name=t,pieChartOption.series[0].data[0].value=e,pieChartOption.series[0].data[1].value=100-e,0==a?d="一":1==a?d="二":2==a?d="三":3==a&&(d="四"),gxtime1=Number(a)+1,pieChartOption.title.text=i+"年"+d+"季度";var n=document.getElementById("pie"),l=echarts.init(n);l.setOption(pieChartOption),l.off("click"),l.on("click",function(e){var t="/static/page/index/saler_turnover_list.html?year="+i+"&gxtime="+gxtime1+"&USER_ID="+o+"&flag=3";layer.open({type:2,title:"商务顾问业绩目标-到款金额完成情况",content:t,area:["100%","100%"]})})},dxhx2:function(e,t,i){var a=this;pieChartOption2.series[0].data[0].name=t,pieChartOption2.series[0].data[0].value=e,pieChartOption2.series[0].data[1].value=100-e,pieChartOption2.title.text=i+"月份";var o=document.getElementById("pie2"),d=echarts.init(o);d.setOption(pieChartOption2),d.off("click"),d.on("click",function(e){var t="/static/page/index/saler_hetong_list.html?gxtime="+i+"&saleId="+a.saleId2;layer.open({type:2,title:"商务顾问业绩目标-合同数量完成情况",content:t,area:["100%","100%"]})})},dxhx3:function(e,t,i){var a=this;pieChartOption3.series[0].data[0].name=t,pieChartOption3.series[0].data[0].value=e,pieChartOption3.series[0].data[1].value=100-e;var o=document.getElementById("pie3");pieChartOption3.title.text=i+"月份";var d=echarts.init(o);d.setOption(pieChartOption3),d.off("click"),d.on("click",function(e){var t="/static/page/index/saler_weian_list.html?gxtime="+i+"&saleId="+a.saleId3;layer.open({type:2,title:"商务顾问业绩目标-委案金额",content:t,area:["100%","100%"]})})},dxhx4:function(e,t){pieChartOption4.series[0].data[0].name=t,pieChartOption4.series[0].data[0].value=e,pieChartOption4.series[0].data[1].value=100-e;var i=document.getElementById("pie4"),a=echarts.init(i);a.setOption(pieChartOption4),a.off("click"),a.on("click",function(e){var t="/static/page/index/saler_follow_list.html?startTime="+t0+"&endTime="+t1+"&type=1&saleId="+id+"&saleName="+config.saleName;layer.open({type:2,title:"电话量",content:t,area:["100%","100%"]})})},nowMonth:function(){var e=new Date,t=e.getFullYear(),i=e.getMonth()+1;return i=i<10?"0"+i:i,t.toString()+"-"+i.toString()}}})}),window.parentFnc=function(e){layer.closeAll(),window.app.getCaseRecord(window.app.type)};